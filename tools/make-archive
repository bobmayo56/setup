#!/usr/bin/env bash

# make-archive

# part of a pair: make-archive and extract-archive 

if [ $# -ne 2 ]; then
    echo "Usage: make-archive <folder> <archive-name>"
    echo "Example: make-archive documents docs-2026"
    exit 1
fi

FOLDER=$1
ARCHIVE=$2

if [ ! -d "$FOLDER" ]; then
    echo "Error: '$FOLDER' is not a directory"
    exit 1
fi

SEVENZIP_PROGRAM="${SEVENZIP_PROGRAM:-7zz}"

# -p with no value attached prompts interactively for a password
# -mhe=on encrypts the archive headers as well as the contents
"$SEVENZIP_PROGRAM" a -mhe=on -p "${ARCHIVE}.7z" "$FOLDER" && echo "Created: ${ARCHIVE}.7z"

